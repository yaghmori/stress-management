# سیستم مدیریت استرس و آموزش آرام‌سازی

یک برنامه دسکتاپ Python کامل و آماده تولید با استفاده از PySide6 (Qt for Python) با پشتیبانی کامل UI فارسی RTL.

## ویژگی‌ها

- **UI فارسی RTL کامل**: چیدمان راست‌به‌چپ کامل با متن فارسی که از ترجمه‌های JSON بارگذاری می‌شود
- **سیستم ترجمه**: تمام متون UI در فایل‌های JSON ذخیره می‌شوند - هیچ کاراکتر فارسی در کد منبع Python وجود ندارد
- **ثبت استرس**: ردیابی روزانه سطح استرس با یادداشت‌ها، ساعت خواب و فعالیت بدنی
- **مدیریت تمرین**: 8 تمرین مختلف شامل تنفس، مدیتیشن، آرام‌سازی، نوشتن و فعالیت بدنی
- **ردیابی جلسات**: ردیابی جلسات تمرین تکمیل شده
- **تست استرس**: ارزیابی استرس با دو تست PSS-10 و PSS-5 (مقیاس استرس ادراک شده)
- **گزارش‌ها و خروجی**: خروجی گزارش‌های استرس به فرمت‌های CSV، Excel و PDF با پشتیبانی کامل RTL
- **تقویم شمسی**: استفاده از تقویم شمسی برای نمایش و انتخاب تاریخ‌ها

## معماری

این برنامه از یک معماری لایه‌ای تمیز پیروی می‌کند:

```
/app
  /ui              # لایه UI (ویجت‌های PySide6)
    /screens       # صفحات اصلی برنامه
    /widgets       # ویجت‌های سفارشی (PersianDateEdit)
  /services        # لایه منطق تجاری (PDF, Excel, Stress, Exercise, etc.)
  /data            # لایه دسترسی به داده (SQLite + Repositories)
  /config          # پیکربندی (Translation Manager, Config, Font Manager)
/translations      # فایل‌های ترجمه JSON
main.py            # نقطه ورود برنامه
seed_database.py   # اسکریپت بارگذاری داده‌های اولیه
```

## سیستم ترجمه

تمام متون UI در `/translations/fa.json` ذخیره می‌شوند. برنامه از کلاس `TranslationManager` برای بارگذاری و بازیابی رشته‌های ترجمه شده استفاده می‌کند.

**ویژگی‌های کلیدی:**

- تمام متن فارسی فقط در فایل‌های JSON
- صفر کاراکتر فارسی در کد منبع Python
- پشتیبانی آسان از تعویض زبان
- جستجوی کلید ترجمه با امنیت نوع

**استفاده در کد:**

```python
from app.config.translation_manager import TranslationManager

tm = TranslationManager()
label.setText(tm.t("login"))  # متن فارسی را از JSON برمی‌گرداند
```

## نصب

1. **نصب وابستگی‌ها:**

   ```bash
   pip install -r requirements.txt
   ```

2. **بارگذاری داده‌های اولیه (اختیاری):**

   ```bash
   python seed_database.py
   ```

   این اسکریپت تمرینات و تست‌های استرس را به پایگاه داده اضافه می‌کند.

3. **اجرای برنامه:**

   ```bash
   python main.py
   ```

## پایگاه داده

این برنامه از پایگاه داده SQLite استفاده می‌کند که در `/data/stress_management.db` ذخیره می‌شود. طرح پایگاه داده به صورت خودکار در اولین اجرا ایجاد می‌شود.

**جداول:**

- `users`: حساب‌های کاربری و احراز هویت
- `stress_logs`: ورودی‌های روزانه سطح استرس
- `exercises`: تمرینات موجود
- `sessions`: تاریخچه جلسات تمرین
- `anxiety_tests`: تست‌های استرس (PSS-10 و PSS-5)
- `anxiety_test_questions`: سوالات تست‌های استرس
- `anxiety_test_results`: نتایج تست‌های استرس کاربران

## پشتیبانی RTL

این برنامه کاملاً با RTL (راست‌به‌چپ) سازگار است:

- تمام ویجت‌ها از جهت چیدمان `Qt.RightToLeft` استفاده می‌کنند
- برچسب‌های فرم در سمت راست ظاهر می‌شوند
- سربرگ‌ها و محتوای جدول RTL هستند
- پشتیبانی فونت فارسی (Vazir/IRANSans با fallback)

## استایل بومی Windows

این برنامه از استایل بومی "windowsvista" Windows برای ظاهر و احساس بومی در Windows استفاده می‌کند.

## وابستگی‌ها

- **PySide6**: فریمورک UI
- **jdatetime**: پشتیبانی از تقویم شمسی
- **reportlab**: تولید گزارش‌های PDF
- **openpyxl**: تولید فایل‌های Excel
- **arabic-reshaper** و **python-bidi**: پشتیبانی از متن RTL در PDF و Excel

## کیفیت کد

- **کد فقط انگلیسی**: تمام کد منبع Python به انگلیسی است
- **نوع‌های اشاره‌ای**: حاشیه‌نویسی‌های کامل نوع در سراسر
- **Docstrings**: مستندات جامع
- **مطابق PEP8**: از دستورالعمل‌های سبک Python پیروی می‌کند
- **لاگ‌گیری**: لاگ‌های چرخشی فایل برای اشکال‌زدایی
- **مدیریت خطا**: پیام‌های خطای کاربرپسند (ترجمه شده)

## تمرینات موجود

برنامه شامل 8 تمرین مختلف است:

1. **تنفس عمیق ۴-۷-۸** (5 دقیقه) - تکنیک تنفس آرام‌ساز برای کاهش سریع استرس
2. **تنفس دیافراگمی** (4 دقیقه) - تنفس آرام با تمرکز بر دیافراگم جهت کنترل اضطراب
3. **مدیتیشن ذهن‌آگاهی** (10 دقیقه) - تمرکز بر لحظه حال برای کاهش حواس‌پرتی و اضطراب
4. **مدیتیشن اسکن بدن** (12 دقیقه) - آگاه‌سازی از تنش‌های بدنی و رهاسازی آن
5. **ریلکسیشن عضلانی تدریجی** (8 دقیقه) - انقباض و رهاسازی عضلات برای کاهش تنش
6. **نوشتن نگرانی‌ها** (7 دقیقه) - ثبت نگرانی‌ها روی کاغذ برای تخلیه ذهن
7. **پیاده‌روی سبک** (15 دقیقه) - حرکت ملایم برای بهبود خلق و سطح استرس
8. **کشش‌های سبک** (6 دقیقه) - حرکات کششی برای رهاسازی تنش فیزیکی

## تست‌های استرس

برنامه شامل دو تست استاندارد برای ارزیابی سطح استرس است:

- **PSS-10 (مقیاس استرس ادراک شده - 10 سوال)**: ارزیابی جامع سطح استرس در ماه گذشته
- **PSS-5 (مقیاس استرس ادراک شده - 5 سوال)**: نسخه کوتاه‌تر برای ارزیابی سریع

هر دو تست شامل تفسیر خودکار نتایج (سطح استرس پایین، متوسط یا بالا) هستند.

## خروجی گزارش‌ها

برنامه از سه فرمت مختلف برای خروجی گزارش‌های استرس پشتیبانی می‌کند:

- **CSV**: خروجی ساده و قابل استفاده در Excel
- **Excel (XLSX)**: فرمت کامل با قالب‌بندی، رنگ‌بندی و پشتیبانی RTL
- **PDF**: گزارش حرفه‌ای با نمودارها و آمارهای تحلیلی

همه فرمت‌ها از پشتیبانی کامل RTL و نمایش صحیح متن فارسی برخوردارند.

## توسعه

### افزودن ترجمه‌های جدید

1. جفت‌های کلید-مقدار جدید را به `/translations/fa.json` اضافه کنید
2. کلید را در کد استفاده کنید: `tm.t("your_new_key")`

### افزودن صفحه‌های جدید

1. ویجت صفحه را در `/app/ui/screens/` ایجاد کنید
2. به `MainWindow._create_screens()` اضافه کنید
3. دکمه ناوبری را در نوار کناری اضافه کنید

### افزودن تمرینات جدید

1. تمرین جدید را به تابع `seed_exercises()` در `seed_database.py` اضافه کنید
2. یا مستقیماً از طریق رابط کاربری (در صورت وجود) اضافه کنید

## مجوز

این پروژه همان‌طور که هست برای اهداف آموزشی و توسعه ارائه می‌شود.

## پشتیبانی

برای مشکلات یا سوالات، لطفاً به مستندات کد و نظرات درون خطی مراجعه کنید.
